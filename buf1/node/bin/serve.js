#!/usr/bin/env node
"use strict";var e=require("@babel/runtime/helpers/interopRequireDefault"),a=require("@babel/runtime/helpers/typeof"),o=e(require("@babel/runtime/regenerator")),r=e(require("@babel/runtime/helpers/asyncToGenerator")),t=e(require("chalk")),n=require("commander"),u=require("../utl/print"),c=require("../utl/path"),i=require("../pro/project"),p=l(require("../pro/react-csr")),s=require("../scr/react-csr");function f(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(f=function(e){return e?t:r})(e)}function l(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};r=f(r);if(r&&r.has(e))return r.get(e);var t,n,o={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&((n=u?Object.getOwnPropertyDescriptor(e,t):null)&&(n.get||n.set)?Object.defineProperty(o,t,n):o[t]=e[t]);return o.default=e,r&&r.set(e,o),o}process.env.XT_CMD="serve",process.on("unhandledRejection",function(e){return(0,u.printExitError)(e)}),process.on("uncaughtException",function(e){return(0,u.printExitError)(e,1)}),(0,u.printInfo)("welcome to use ".concat(t.default.blue("xueyan-typescript-cli")));var d=new n.Command;function b(e){return y.apply(this,arguments)}function y(){return(y=(0,r.default)(o.default.mark(function e(r){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,c.cwdPath)(r||""),process.env.XT_PATH=t,t=(0,i.readProjectMeta)(t),process.env.XT_TYPE=t.type,n=t.type===p.REACT_CSR_TYPE?new s.ReactCSRServer({project:new p.default(t)}):n)return e.next=8,n.open();e.next=10;break;case 8:e.next=11;break;case 10:throw Error("please indicates the type of project in config file");case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}d.description("open project server").arguments("[path]").action(b).parse(process.argv);