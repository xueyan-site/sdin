"use strict";var e=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var a=e(require("@babel/runtime/regenerator")),c=e(require("@babel/runtime/helpers/asyncToGenerator")),u=e(require("@babel/runtime/helpers/classCallCheck")),o=e(require("@babel/runtime/helpers/createClass")),i=e(require("@babel/runtime/helpers/inherits")),s=e(require("@babel/runtime/helpers/possibleConstructorReturn")),l=e(require("@babel/runtime/helpers/getPrototypeOf")),p=e(require("ora")),f=e(require("chalk")),t=e(require("../../../exe/starter")),h=require("../../../utl/print"),b=require("./server"),d=require("./webpack"),m=require("../common/check");function q(r){var n=v();return function(){var e,t=(0,l.default)(r);return t=n?(e=(0,l.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,s.default)(this,t)}}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var r=function(e){(0,i.default)(n,e);var t,r=q(n);function n(e){return(0,u.default)(this,n),r.call(this,e)}return(0,o.default)(n,[{key:"main",value:(t=(0,c.default)(a.default.mark(function e(){var t,r,n,c=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(0,h.printLoading)("checking project ".concat(this.project.name)),e.next=3,(0,m.precheck)(this.project);case 3:if(n=e.sent)return e.abrupt("return",(0,h.printExitError)(n));e.next=8;break;case 8:(0,h.printSuccess)("".concat(this.project.name," has no questions"));case 9:return console.log(),r=(0,p.default)("".concat(this.project.name," compiler ").concat(f.default.blue("creating"))).start(),e.prev=11,e.next=14,(0,d.createWebpack)(this.project);case 14:return n=e.sent,e.next=17,(0,b.createServer)(this.project,n);case 17:t=e.sent,r.succeed("".concat(this.project.name," compiler created ").concat(f.default.blue("successfully"))),e.next=25;break;case 21:return e.prev=21,e.t0=e.catch(11),r.fail("".concat(this.project.name," compiler created ").concat(f.default.red("failed"))),e.abrupt("return",console.error(e.t0));case 25:if(t)return t.listen(this.project.start.port,function(){console.log("".concat(c.project.name," compiler listening on ").concat(f.default.blue("http://127.0.0.1:"+c.project.start.port),"\n"))}),e.abrupt("return",new Promise(function(e){c.on("close",function(){t.emit("close"),e()})}));e.next=28;break;case 28:case"end":return e.stop()}},e,this,[[11,21]])})),function(){return t.apply(this,arguments)})}]),n}(t.default);exports.default=r;