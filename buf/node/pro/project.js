"use strict";var t=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.readProjectMeta=e,exports.default=void 0;var r=t(require("@babel/runtime/helpers/classCallCheck")),i=t(require("@babel/runtime/helpers/createClass")),o=require("../utl/path"),s=require("../utl/read");function e(t){var i=(0,s.readPackageInfoSync)(t),e=(0,s.readJsonSync)("project.js",t);return{type:e.type||"",root:t,config:e,package:i}}var a=function(){function e(t,i){(0,r.default)(this,e),this.type=t,this.root=i.root,this.buf=this.withRoot("buf"),this.src=this.withRoot("src"),this.pub=this.withRoot("pub"),this.doc=this.withRoot("doc"),this.mdl=this.withRoot("node_modules"),this.tsc=this.withRoot("tsconfig.json"),this.dist=this.withRoot("dist"),this.astDist=this.withDist("ast"),this.defDist=this.withDist("def"),this.webDist=this.withDist("web"),this.nodeDist=this.withDist("node");t=this.package=i.package||(0,s.readPackageInfoSync)(this.root),i=this.config=(0,s.readJsonSync)(i.config||"project.js",this.root);this.author=t.author,this.version=t.version,this.name=i.name||t.name,this.id=[this.type,t.name,this.version].join("_"),this.alias=i.alias}return(0,i.default)(e,[{key:"withRoot",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.root].concat(i))}},{key:"withBuf",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.buf].concat(i))}},{key:"withSrc",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.src].concat(i))}},{key:"withPub",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.pub].concat(i))}},{key:"withDoc",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.doc].concat(i))}},{key:"withDist",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.dist].concat(i))}},{key:"withMdl",value:function(){for(var t=arguments.length,i=new Array(t),e=0;e<t;e++)i[e]=arguments[e];return o.withPath.apply(void 0,[this.mdl].concat(i))}},{key:"getDepVersion",value:function(t){var i=this.package.dependencies;return i&&i[t]||""}},{key:"getTsconfig",value:function(){return this.__tsConfig__||(this.__tsConfig__=(0,s.readJsonSync)(this.tsc)),this.__tsConfig__}}]),e}();exports.default=a;