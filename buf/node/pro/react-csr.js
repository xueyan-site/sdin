"use strict";var e=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.REACT_CSR_TYPE=void 0;var u=e(require("@babel/runtime/helpers/classCallCheck")),t=e(require("@babel/runtime/helpers/createClass")),n=e(require("@babel/runtime/helpers/assertThisInitialized")),i=e(require("@babel/runtime/helpers/inherits")),l=e(require("@babel/runtime/helpers/possibleConstructorReturn")),s=e(require("@babel/runtime/helpers/getPrototypeOf")),o=e(require("@babel/runtime/helpers/defineProperty")),c=e(require("fs-extra")),p=require("lodash"),r=e(require("./application")),f=e(require("./react-csr-page"));function a(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){(0,o.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function b(r){var a=h();return function(){var e,t=(0,s.default)(r);return t=a?(e=(0,s.default)(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),(0,l.default)(this,t)}}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var y="react-csr";exports.REACT_CSR_TYPE=y;var g=function(e){(0,i.default)(a,e);var r=b(a);function a(e){var t;(0,u.default)(this,a),t=r.call(this,y,e),(0,o.default)((0,n.default)(t),"pageList",[]),(0,o.default)((0,n.default)(t),"__pageMap__",{});e=t.config;return t.astPub=t.withPub("ast"),t.index=e.index,t.error=e.error,t.module=(0,p.defaultsDeep)({},e.module,{externals:{},babelIncludes:[],babelExcludes:[]}),t.serve=(0,p.defaultsDeep)({},e.serve,{port:443,proxy:[]}),t.start=(0,p.defaultsDeep)({},e.start,d(d({},t.serve),{},{port:8080})),t.__pageConfig__=e.page||{},t.pageList=t.getPageList(),t.__pageMap__=(0,p.keyBy)(t.pageList,"path"),t}return(0,t.default)(a,[{key:"getPage",value:function(e){return this.__pageMap__[e||""]}},{key:"getPageList",value:function(){for(var e=[],t=c.default.readdirSync(this.src),r=0;r<t.length;r++){var a=t[r],u=this.withSrc(a);c.default.statSync(u).isDirectory()&&e.push(new f.default({folder:a,project:this}))}return e}}]),a}(r.default);exports.default=g;